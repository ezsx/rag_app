# fetch_docs - Инструмент получения документов

## Обзор

Инструмент `fetch_docs` выполняет батч-загрузку документов по списку ID из активной коллекции ChromaDB. Используется агентом для получения полных текстов документов после поиска.

## Функциональность

### Основные возможности
- **Батч-загрузка**: Получение нескольких документов за один запрос
- **Fallback обработка**: Возврат заглушек при ошибках загрузки
- **Гибкие параметры**: Поддержка различных способов задания ID документов
- **Интеграция с ChromaDB**: Работа через Retriever интерфейс

### Параметры
- `retriever` (Retriever): Экземпляр ретривера для доступа к ChromaDB
- `ids` (List[str], опционально): Основной список ID документов
- `window` (List[int], опционально): Неиспользуемый параметр для совместимости
- `doc_ids` (List[str], опционально): Альтернативный список ID документов

### Возвращаемые данные
```python
{
    "docs": [
        {
            "id": "string",
            "text": "string",
            "metadata": {...}
        }
    ]
}
```

## Алгоритм работы

1. **Валидация параметров**: Определение списка ID из различных параметров
2. **Проверка пустоты**: Возврат пустого результата при отсутствии ID
3. **Запрос к ChromaDB**: Вызов `retriever.get_by_ids()` для получения документов
4. **Обработка ошибок**: Возврат заглушек с пустым текстом при неудаче

## Интеграция с агентом

Используется в ReAct цикле для:
- Получения полных текстов документов после этапа `compose_context`
- Подготовки данных для финального ответа агента
- Обеспечения доступа к исходным документам по их ID

## Обработка ошибок

- Graceful degradation: при ошибках загрузки возвращает документы-заглушки
- Логирование всех операций с детализацией для отладки
- Сохранение структуры ответа даже при частичных ошибках

## Производительность

- Батч-операции для эффективной загрузки нескольких документов
- Минимальное количество запросов к базе данных
- Кеширование через интеграцию с Retriever
